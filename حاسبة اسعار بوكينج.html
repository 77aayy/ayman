<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Elite Price System â€“ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªØ´ØºÙŠÙ„ Ø£ÙŠÙ…Ù† Ø£Ø¨Ùˆ ÙˆØ±Ø¯Ù‡</title>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap" rel="stylesheet">
    <style>
        /* ========================= Ø§Ù„Ø¥Ø·Ø§Ø±Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© Ù„Ù„Ø­Ø±ÙƒØ§Øª ========================= */
        @keyframes fadeInDown {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes pulse {
            0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(201, 167, 78, 0.7); }
            70% { transform: scale(1.05); box-shadow: 0 0 15px 10px rgba(201, 167, 78, 0); }
            100% { transform: scale(1); }
        }

        /* ========================= CSS Ù…ÙˆØ­Ø¯ Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„ØµÙØ­Ø§Øª ========================= */
        body {
            font-family: 'Tajawal', sans-serif;
            background: #0F1A2F; 
            color: #fff;
            text-align: center;
            margin: 0;
            padding: 0;
        }

        /* ========================= ØªØµÙ…ÙŠÙ… ØµÙØ­Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ ========================= */
        #loginContainer {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
        }
        .login-box {
            background: rgba(15, 26, 47, 0.7); 
            border: 1px solid #c9a74e;
            border-radius: 12px;
            padding: 50px 40px;
            width: 320px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            animation: fadeInDown 0.8s ease-out;
        }
        .login-box h1 {
            color: #e8d39e;
            font-size: 32px;
            margin-bottom: 35px;
            font-weight: 700;
        }
        .textbox {
            position: relative;
            margin-bottom: 30px;
        }
        .textbox input {
            width: 100%;
            padding: 12px 10px;
            background: none;
            border: none;
            border-bottom: 2px solid #5a4b70;
            outline: none;
            color: white;
            font-size: 17px;
            text-align: right;
            transition: border-bottom 0.3s;
        }
        .textbox input:focus {
            border-bottom: 2px solid #c9a74e;
        }
        .textbox label {
            position: absolute;
            top: 12px;
            right: 10px;
            color: #aaa;
            font-size: 17px;
            transition: .3s ease-in-out;
            pointer-events: none;
        }
        .textbox input:focus + label,
        .textbox input:valid + label {
            top: -20px;
            right: 0px;
            font-size: 13px;
            color: #e8d39e;
        }
        #status-area {
            margin-top: 25px;
            min-height: 45px;
        }
        #message {
            font-weight: bold;
            font-size: 16px;
            margin-bottom: 8px;
        }
        .success-color {
            color: #4CAF50; 
        }
        .error-color {
            color: #ff6347;
        }
        .progress-container {
            height: 4px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 2px;
            overflow: hidden;
            margin-bottom: 15px;
            visibility: hidden;
        }
        #progressBar {
            height: 100%;
            width: 0%;
            background-color: #4CAF50; 
            transition: width 2s linear;
        }
        .btn {
            animation: pulse 2s infinite; 
            background: #c9a74e;
            color: #0F1A2F; 
            border: none;
            padding: 12px 25px;
            border-radius: 10px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            margin-top: 20px;
            transition: 0.3s;
        }
        .btn:hover {
            background: #e8d39e;
            box-shadow: 0 0 15px rgba(232, 211, 158, 0.5);
            animation: none; 
        }
        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            animation: none;
        }


        /* ========================= ØªØµÙ…ÙŠÙ… ØµÙØ­Ø© Ø§Ù„Ù…Ø­ØªÙˆÙ‰ (Ø§Ù„Ø£Ø³Ø¹Ø§Ø±) ========================= */
        #contentContainer {
            padding: 30px 20px;
        }
        #contentContainer h1 {
            color: #e8d39e; 
            font-size: 40px;
            margin-bottom: 30px;
            letter-spacing: 1px;
            text-shadow: 0 0 5px rgba(232, 211, 158, 0.2);
            animation: fadeInDown 1s ease-out;
        }
        .branch {
            width: 90%;
            max-width: 1000px;
            margin: 35px auto;
            background: rgba(255, 255, 255, 0.03); 
            border: 1px solid rgba(201, 167, 78, 0.5); 
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.4); 
            transition: transform 0.3s;
            opacity: 0; 
        }
        .branch:hover {
            transform: translateY(-5px);
        }
        .branch h2 {
            color: #c9a74e;
            font-size: 28px;
            border-bottom: 2px solid rgba(201, 167, 78, 0.3);
            padding-bottom: 15px;
            margin-bottom: 20px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 18px;
            margin-top: 15px;
        }
        th, td {
            padding: 15px 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            text-align: center;
        }
        th {
            color: #e8d39e;
            background: rgba(201, 167, 78, 0.1);
            font-size: 20px;
        }
        td:first-child {
            text-align: right;
            padding-right: 20px;
        }
        
        input[type=number] {
            width: 110px;
            text-align: center;
            border-radius: 6px;
            border: 1px solid #c9a74e;
            font-size: 24px; 
            font-weight: bold;
            font-family: monospace;
            padding: 5px;
            background: #1a2a47; 
            color: #fff;
        }
        .rate-input {
            width: 80px; 
        }
        
        input.booking {
            background: #3a4a67; 
            color: #fff;
            border: 1px solid #4CAF50; 
        }
        .unify {
            margin: 10px 0 25px;
            font-size: 18px;
            background: rgba(201, 167, 78, 0.05);
            padding: 10px;
            border-radius: 8px;
        }
        .footer {
            color: #e8d39e;
            margin-top: 40px;
            font-size: 16px;
            padding: 10px;
            border-top: 1px solid rgba(201, 167, 78, 0.3);
        }

        .logout-btn {
            position: absolute;
            top: 20px;
            left: 20px;
            background: #ff6347; /* Ù„ÙˆÙ† Ø£Ø­Ù…Ø± */
            color: #fff;
            padding: 8px 15px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
            z-index: 100;
        }
        .logout-btn:hover {
            background: #e8553f;
        }
    </style>
</head>
<body>

    <div id="loginContainer">
        <div class="login-box">
            <h1>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h1>
            <form id="loginForm">
                
                <div class="textbox">
                    <input type="text" id="username" required>
                    <label for="username">Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</label>
                </div>

                <div class="textbox">
                    <input type="password" id="password" required>
                    <label for="password">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
                </div>

                <div id="status-area">
                    <div class="progress-container">
                        <div id="progressBar"></div>
                    </div>
                    <div id="message"></div>
                </div>

                <button type="submit" class="btn">Ø¯Ø®ÙˆÙ„</button>
            </form>
        </div>
    </div>

    <div id="contentContainer" style="display:none; padding-top: 30px; position: relative;">
        
        <button class="logout-btn" onclick="setupLoginPage()">ğŸ”’ ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬</button>

        <h1 style="padding: 0 20px;">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªØ´ØºÙŠÙ„ â€“ Ø£ÙŠÙ…Ù† Ø£Ø¨Ùˆ ÙˆØ±Ø¯Ù‡</h1>

        <div class="branch" id="corniche">
            <h2>ğŸ¨ ÙØ±Ø¹ Ø§Ù„ÙƒÙˆØ±Ù†ÙŠØ´</h2>
            <div class="unify">
                <label><input type="checkbox" id="unifyC" onchange="setUnify('c')"> ØªÙˆØ­ÙŠØ¯ Ø§Ù„Ù†Ø³Ø¨Ø© Ø¹Ù„Ù‰ Ø¬Ù…ÙŠØ¹ Ø§Ù„ØµÙÙˆÙ</label>
                <input type="number" id="rateC" value="45" onchange="setUnify('c')"> %
            </div>
            <table>
                <tr><th>Ù…ÙƒÙˆÙ†Ø§Øª Ø§Ù„ÙˆØ­Ø¯Ø©</th><th>Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø¹Ø§Ø¯ÙŠ</th><th>Ù†Ø³Ø¨Ø© Ø§Ù„Ø²ÙŠØ§Ø¯Ø© (%)</th><th>Ø³Ø¹Ø± Ø¨ÙˆÙƒÙŠÙ†Ø¬</th></tr>
                <tr><td>ØªØ¤Ù… ÙˆÙƒÙŠÙ†Ø¬</td><td><input id="c_p1" value="230" oninput="calc('c',1)"></td><td><input id="c_r1" value="45" oninput="calc('c',1)" class="rate-input"></td><td><input id="c_b1" class="booking" readonly></td></tr>
                <tr><td>Ø³ØªÙˆØ¯ÙŠÙˆ</td><td><input id="c_p2" value="340" oninput="calc('c',2)"></td><td><input id="c_r2" value="45" oninput="calc('c',2)" class="rate-input"></td><td><input id="c_b2" class="booking" readonly></td></tr>
                <tr><td>Ø´Ù‚Ø© ØºØ±ÙØ© ÙˆØµØ§Ù„Ø©</td><td><input id="c_p3" value="370" oninput="calc('c',3)"></td><td><input id="c_r3" value="45" oninput="calc('c',3)" class="rate-input"></td><td><input id="c_b3" class="booking" readonly></td></tr>
                <tr><td>ØºØ±ÙØªÙŠÙ† ÙˆØµØ§Ù„Ø©</td><td><input id="c_p4" value="400" oninput="calc('c',4)"></td><td><input id="c_r4" value="45" oninput="calc('c',4)" class="rate-input"></td><td><input id="c_b4" class="booking" readonly></td></tr>
                <tr><td>VIP</td><td><input id="c_p5" value="850" oninput="calc('c',5)"></td><td><input id="c_r5" value="45" oninput="calc('c',5)" class="rate-input"></td><td><input id="c_b5" class="booking" readonly></td></tr>
            </table>
            <button class="btn" onclick="downloadExcel('c')">ğŸ’¾ ØªØ­Ù…ÙŠÙ„ Ø£Ø³Ø¹Ø§Ø± ÙØ±Ø¹ Ø§Ù„ÙƒÙˆØ±Ù†ÙŠØ´ (Excel)</button>
        </div>

        <div class="branch" id="andalus">
            <h2>ğŸ¨ ÙØ±Ø¹ Ø§Ù„Ø£Ù†Ø¯Ù„Ø³</h2>
            <div class="unify">
                <label><input type="checkbox" id="unifyA" onchange="setUnify('a')"> ØªÙˆØ­ÙŠØ¯ Ø§Ù„Ù†Ø³Ø¨Ø© Ø¹Ù„Ù‰ Ø¬Ù…ÙŠØ¹ Ø§Ù„ØµÙÙˆÙ</label>
                <input type="number" id="rateA" value="45" onchange="setUnify('a')"> %
            </div>
            <table>
                <tr><th>Ù…ÙƒÙˆÙ†Ø§Øª Ø§Ù„ÙˆØ­Ø¯Ø©</th><th>Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø¹Ø§Ø¯ÙŠ</th><th>Ù†Ø³Ø¨Ø© Ø§Ù„Ø²ÙŠØ§Ø¯Ø© (%)</th><th>Ø³Ø¹Ø± Ø¨ÙˆÙƒÙŠÙ†Ø¬</th></tr>
                <tr><td>ØºØ±ÙØ© ÙˆØ­Ù…Ø§Ù… Ø®Ù„ÙÙŠØ© Ø³Ø±ÙŠØ±ÙŠÙ† (ØªØ¤Ù…)</td><td><input id="a_p1" value="190" oninput="calc('a',1)"></td><td><input id="a_r1" value="45" oninput="calc('a',1)" class="rate-input"></td><td><input id="a_b1" class="booking" readonly></td></tr>
                <tr><td>ØºØ±ÙØ© ÙˆØ­Ù…Ø§Ù… Ø®Ù„ÙÙŠØ© Ø³Ø±ÙŠØ± Ù…Ø²Ø¯ÙˆØ¬ (ÙƒÙŠÙ†Ø¬)</td><td><input id="a_p2" value="205" oninput="calc('a',2)"></td><td><input id="a_r2" value="45" oninput="calc('a',2)" class="rate-input"></td><td><input id="a_b2" class="booking" readonly></td></tr>
                <tr><td>ØºØ±ÙØ© Ù…Ø·Ù„Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø§Ø±Ø¹ (Ø³ØªÙˆØ¯ÙŠÙˆ)</td><td><input id="a_p3" value="220" oninput="calc('a',3)"></td><td><input id="a_r3" value="45" oninput="calc('a',3)" class="rate-input"></td><td><input id="a_b3" class="booking" readonly></td></tr>
                <tr><td>ØºØ±ÙØ© ÙˆØµØ§Ù„Ø© Ù…Ø·Ù„Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø§Ø±Ø¹</td><td><input id="a_p4" value="290" oninput="calc('a',4)"></td><td><input id="a_r4" value="45" oninput="calc('a',4)" class="rate-input"></td><td><input id="a_b4" class="booking" readonly></td></tr>
                <tr><td>ØºØ±ÙØªÙŠÙ† Ø®Ù„ÙÙŠØªÙŠÙ† Ø³Ø±ÙŠØ± Ù…Ø²Ø¯ÙˆØ¬ ÙˆØ³Ø±ÙŠØ±ÙŠÙ† ØªØ¤Ø§Ù… (3+4)</td><td><input id="a_p5" value="390" oninput="calc('a',5)"></td><td><input id="a_r5" value="45" oninput="calc('a',5)" class="rate-input"></td><td><input id="a_b5" class="booking" readonly></td></tr>
                <tr><td>ØºØ±ÙØªÙŠÙ† ÙˆØµØ§Ù„Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø§Ø±Ø¹ Ø³Ø±ÙŠØ±ÙŠÙ† Ù…Ø²Ø¯ÙˆØ¬ (2+1)</td><td><input id="a_p6" value="420" oninput="calc('a',6)"></td><td><input id="a_r6" value="45" oninput="calc('a',6)" class="rate-input"></td><td><input id="a_b6" class="booking" readonly></td></tr>
                <tr><td>ØºØ±ÙØªÙŠÙ† ÙˆØµØ§Ù„Ø© ÙˆÙ…Ù„Ø­Ù‚ ÙˆØ¬Ø§ÙƒÙˆØ²ÙŠ ÙˆØ¨Ø®Ø§Ø± VIP 601</td><td><input id="a_p7" value="570" oninput="calc('a',7)"></td><td><input id="a_r7" value="45" oninput="calc('a',7)" class="rate-input"></td><td><input id="a_b7" class="booking" readonly></td></tr>
                <tr><td>ØºØ±ÙØ© ÙˆØµØ§Ù„Ø© ÙˆØ¬Ø§ÙƒÙˆØ²ÙŠ VIP 602</td><td><input id="a_p8" value="370" oninput="calc('a',8)"></td><td><input id="a_r8" value="45" oninput="calc('a',8)" class="rate-input"></td><td><input id="a_b8" class="booking" readonly></td></tr>
                <tr><td>ØºØ±ÙØ© ÙˆÙ…Ù„Ø­Ù‚ Ø®Ø§Ø±Ø¬ÙŠ VIP 604</td><td><input id="a_p9" value="320" oninput="calc('a',9)"></td><td><input id="a_r9" value="45" oninput="calc('a',9)" class="rate-input"></td><td><input id="a_b9" class="booking" readonly></td></tr>
            </table>
            <button class="btn" onclick="downloadExcel('a')">ğŸ’¾ ØªØ­Ù…ÙŠÙ„ Ø£Ø³Ø¹Ø§Ø± ÙØ±Ø¹ Ø§Ù„Ø£Ù†Ø¯Ù„Ø³ (Excel)</button>
        </div>

        <div class="footer" id="footer">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªØ´ØºÙŠÙ„ | Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«: </div>
    </div>


    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <script>
        // ========================= ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ù…Ø­ØªÙˆÙ‰ (Ø­Ø³Ø§Ø¨ Ø§Ù„Ø£Ø³Ø¹Ø§Ø± ÙˆØ§Ù„Ø¥ÙƒØ³Ù„) =========================
        function calc(branch,i){
            let p=parseFloat(document.getElementById(branch+'_p'+i).value)||0;
            let r=parseFloat(document.getElementById(branch+'_r'+i).value)||0;
            document.getElementById(branch+'_b'+i).value=(p*(1+r/100)).toFixed(2);
        }
        function setUnify(branch){
            let unify=document.getElementById(branch==='c'?'unifyC':'unifyA').checked;
            let rate=parseFloat(document.getElementById(branch==='c'?'rateC':'rateA').value);
            let rows=branch==='c'?5:9;
            for(let i=1;i<=rows;i++){
                document.getElementById(branch+'_r'+i).value=unify?rate:45;
                calc(branch,i);
            }
        }
        function arabicDate(d){
            const m=['ÙŠÙ†Ø§ÙŠØ±','ÙØ¨Ø±Ø§ÙŠØ±','Ù…Ø§Ø±Ø³','Ø£Ø¨Ø±ÙŠÙ„','Ù…Ø§ÙŠÙˆ','ÙŠÙˆÙ†ÙŠÙˆ','ÙŠÙˆÙ„ÙŠÙˆ','Ø£ØºØ³Ø·Ø³','Ø³Ø¨ØªÙ…Ø¨Ø±','Ø£ÙƒØªÙˆØ¨Ø±','Ù†ÙˆÙÙ…Ø¨Ø±','Ø¯ÙŠØ³Ù…Ø¨Ø±'];
            return d.getDate()+' '+m[d.getMonth()]+' '+d.getFullYear();
        }

        function applyBranchAnimation() {
            const branches = document.querySelectorAll('.branch');
            branches.forEach((branch, index) => {
                setTimeout(() => {
                    branch.style.opacity = 1;
                    branch.style.animation = `fadeInUp 0.8s ease-out`;
                }, index * 200); 
            });
        }

        function downloadExcel(branch){
            const wb=XLSX.utils.book_new();
            
            // Define Colors
            const NAVY_BG = "0F1A2F";
            const GOLD_ACCENT = "C9A74E";
            const WHITE_TEXT = "FFFFFF";
            const BLACK = "000000";
            const LIGHT_GRAY = "E0E0E0";
            const GREEN_SUCCESS = "4CAF50";

            const title="Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªØ´ØºÙŠÙ„ â€“ Ø£ÙŠÙ…Ù† Ø£Ø¨Ùˆ ÙˆØ±Ø¯Ù‡";
            const branchName=(branch==='c'?'ÙØ±Ø¹ Ø§Ù„ÙƒÙˆØ±Ù†ÙŠØ´':'ÙØ±Ø¹ Ø§Ù„Ø£Ù†Ø¯Ù„Ø³');
            const now=new Date();
            const dateText="ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØµØ¯ÙŠØ±: "+arabicDate(now);
            const timeText="ÙˆÙ‚Øª Ø§Ù„ØªØµØ¯ÙŠØ±: "+now.toLocaleTimeString('en-GB');
            const rows=(branch==='c'?5:9);

            let data=[
                [title],
                [branchName],
                [],
                ["Ù…ÙƒÙˆÙ†Ø§Øª Ø§Ù„ÙˆØ­Ø¯Ø©","Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø¹Ø§Ø¯ÙŠ","Ø³Ø¹Ø± Ø¨ÙˆÙƒÙŠÙ†Ø¬"]
            ];
            for(let i=1;i<=rows;i++){
                data.push([
                    document.querySelector(`#${branch==='c'?'corniche':'andalus'} table tr:nth-child(${i+1}) td:first-child`).innerText,
                    document.getElementById(branch+'_p'+i).value,
                    document.getElementById(branch+'_b'+i).value
                ]);
            }
            data.push([]);
            data.push([dateText]);
            data.push([timeText]);

            const ws=XLSX.utils.aoa_to_sheet(data);
            ws['!cols']=[{wch:40},{wch:15},{wch:20}];

            // Ø¯Ù…Ø¬ Ø§Ù„ØµÙÙˆÙ Ø§Ù„Ø£ÙˆÙ„Ù‰ Ù„ØªØ¸Ù‡Ø± Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø© ÙÙ‚Ø·
            ws['!merges']=[
                {s:{r:0,c:0},e:{r:0,c:2}},
                {s:{r:1,c:0},e:{r:1,c:2}}
            ];

            // --- Ø£Ù†Ù…Ø§Ø· Ø§Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠ Ù„Ù€ Excel ---
            
            const brandingStyle = { 
                font: { bold: true, color: { rgb: GOLD_ACCENT }, sz: 16 }, 
                fill: { fgColor: { rgb: NAVY_BG } }, 
                alignment: { horizontal: "center", vertical: "center" }
            };
            
            const headerStyle = {
                font: { bold: true, color: { rgb: NAVY_BG }, sz: 12 }, 
                fill: { fgColor: { rgb: GOLD_ACCENT } }, 
                alignment: { horizontal: "center", vertical: "center" },
                border: { top: { style: "thin", color: { rgb: BLACK } }, bottom: { style: "thin", color: { rgb: BLACK } }, left: { style: "thin", color: { rgb: BLACK } }, right: { style: "thin", color: { rgb: BLACK } } }
            };
            
            const dataStyle = {
                font: { color: { rgb: BLACK }, sz: 12 },
                fill: { fgColor: { rgb: WHITE_TEXT } },
                alignment: { horizontal: "center", vertical: "center" },
                border: { bottom: { style: "thin", color: { rgb: LIGHT_GRAY } }, left: { style: "thin", color: { rgb: LIGHT_GRAY } }, right: { style: "thin", color: { rgb: LIGHT_GRAY } } }
            };
            
            const bookingStyle = {
                font: { color: { rgb: BLACK }, bold: true, sz: 12 },
                fill: { fgColor: { rgb: GREEN_SUCCESS } },
                alignment: { horizontal: "center", vertical: "center" },
                border: { bottom: { style: "thin", color: { rgb: LIGHT_GRAY } }, left: { style: "thin", color: { rgb: LIGHT_GRAY } }, right: { style: "thin", color: { rgb: LIGHT_GRAY } } }
            };

            const footerStyle = { font: { color: { rgb: NAVY_BG }, sz: 10 } };


            ws["A1"].s = brandingStyle; 
            ws["A2"].s = brandingStyle; 

            ["A4", "B4", "C4"].forEach(c => {
                if (ws[c]) ws[c].s = headerStyle;
            });
            
            for(let i = 1; i <= rows; i++) {
                const rowNum = i + 4;
                
                if (ws['A' + rowNum]) ws['A' + rowNum].s = dataStyle; 
                if (ws['B' + rowNum]) ws['B' + rowNum].s = dataStyle; 
                if (ws['C' + rowNum]) ws['C' + rowNum].s = bookingStyle;
            }
            
            const dateRowIndex = rows + 6;
            const timeRowIndex = rows + 7;
            if (ws['A' + dateRowIndex]) ws['A' + dateRowIndex].s = footerStyle;
            if (ws['A' + timeRowIndex]) ws['A' + timeRowIndex].s = footerStyle;


            ws['!pageSetup']={orientation:"landscape",paperSize:9,centerHorizontally:true,centerVertically:true};

            XLSX.utils.book_append_sheet(wb,ws,(branch==='c'?"Corniche Branch":"Andalus Branch"));
            XLSX.writeFile(wb,(branch==='c'?"Elite_Corniche.xlsx":"Elite_Andalus.xlsx"));
        }


        // ========================= ÙˆØ¸Ø§Ø¦Ù Ø§Ù„ØªØ¨Ø¯ÙŠÙ„ ÙˆØ§Ù„Ø£Ù…Ø§Ù† (Ø¬Ø¯ÙŠØ¯) =========================

        function setupLoginPage() {
            // 1. Ù…Ø³Ø­ Ø­Ø§Ù„Ø© Ø§Ù„Ø¬Ù„Ø³Ø©
            sessionStorage.removeItem('isAuthenticated'); 
            
            // 2. Ø¥Ø¸Ù‡Ø§Ø± ØµÙØ­Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙˆØ¥Ø®ÙØ§Ø¡ Ø§Ù„Ù…Ø­ØªÙˆÙ‰
            document.getElementById('contentContainer').style.display = 'none';
            document.getElementById('loginContainer').style.display = 'flex';
            
            // 3. Ù…Ø³Ø­ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ÙˆØ¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø­Ø§Ù„Ø© (ØªÙ…Øª Ø¥Ø¹Ø§Ø¯Ø© Ù‡Ø°Ø§ Ø§Ù„Ø³Ø·Ø±)
            document.getElementById('password').value = ''; 
            document.getElementById('message').innerText = '';
            
            // 4. ØªÙØ¹ÙŠÙ„ Ø²Ø± Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙˆØ¬Ø¹Ù„Ù‡ Ø¬Ø§Ù‡Ø²Ù‹Ø§ 
            const loginButton = document.querySelector('.btn');
            loginButton.disabled = false; 
            loginButton.style.animation = 'pulse 2s infinite';

            // 5. ØªØ­Ù…ÙŠÙ„ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù…Ø­ÙÙˆØ¸ ÙˆØªØ¹Ø¨Ø¦ØªÙ‡
            const savedUsername = localStorage.getItem('username');
            if (savedUsername) {
                document.getElementById('username').value = savedUsername;
            }
        }

        function showContentPage() {
            // 1. Ø¥Ø¸Ù‡Ø§Ø± ØµÙØ­Ø© Ø§Ù„Ù…Ø­ØªÙˆÙ‰ ÙˆØ¥Ø®ÙØ§Ø¡ Ø§Ù„Ø¯Ø®ÙˆÙ„
            document.getElementById('loginContainer').style.display = 'none';
            document.getElementById('contentContainer').style.display = 'block';

            // 2. ØªØ´ØºÙŠÙ„ ÙˆØ¸Ø§Ø¦Ù Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠØ©
            document.getElementById('footer').innerText+=' '+arabicDate(new Date());
            for(let i=1;i<=5;i++)calc('c',i);
            for(let i=1;i<=9;i++)calc('a',i);
            applyBranchAnimation();
        }

        document.getElementById('loginForm').addEventListener('submit', function(event) {
            event.preventDefault(); 

            const correctUsername = "ayman";
            const correctPassword = "ayman2025";
            
            const enteredUsername = document.getElementById('username').value.trim();
            const enteredPassword = document.getElementById('password').value.trim();
            const messageElement = document.getElementById('message');
            const progressBar = document.getElementById('progressBar');
            const progressContainer = document.querySelector('.progress-container');

            messageElement.innerText = "";
            messageElement.className = "";
            progressBar.style.width = '0%';
            progressContainer.style.visibility = 'hidden';
            
            const loginButton = document.querySelector('.btn');
            loginButton.disabled = true;
            loginButton.style.animation = 'none'; 

            // Ø­ÙØ¸ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù…Ø¯Ø®Ù„ ÙÙˆØ±Ø§Ù‹
            localStorage.setItem('username', enteredUsername);

            // 1. Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù„ØºØ© (ÙˆØ¬ÙˆØ¯ Ø£Ø­Ø±Ù Ø¹Ø±Ø¨ÙŠØ© Ø£Ùˆ ØºÙŠØ± Ù„Ø§ØªÙŠÙ†ÙŠØ©)
            const arabicRegex = /[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF]/; 
            if (arabicRegex.test(enteredUsername) || arabicRegex.test(enteredPassword)) {
                messageElement.innerText = "âš ï¸ Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù„ÙˆØ­Ø© Ø§Ù„Ù…ÙØ§ØªÙŠØ­ Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© ÙÙ‚Ø· (ØªØ£ÙƒØ¯ Ø£Ù† Ø§Ù„Ù„ØºØ© Ù„ÙŠØ³Øª Ø¹Ø±Ø¨ÙŠØ©).";
                messageElement.classList.add('error-color');
                document.getElementById('password').value = '';
                loginButton.disabled = false;
                loginButton.style.animation = 'pulse 2s infinite';
                return; 
            }

            // 2. Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø£Ø­Ø±Ù Ø§Ù„ÙƒØ¨ÙŠØ±Ø© (Uppercase)
            if (enteredUsername !== enteredUsername.toLowerCase() || enteredPassword !== enteredPassword.toLowerCase()) {
                messageElement.innerText = "âš ï¸ Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø£Ø­Ø±Ù Ø§Ù„ØµØºÙŠØ±Ø© (lowercase) ÙÙ‚Ø·.";
                messageElement.classList.add('error-color');
                document.getElementById('password').value = '';
                loginButton.disabled = false;
                loginButton.style.animation = 'pulse 2s infinite';
                return; 
            }
            
            
            // âœ… Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØµØ­ÙŠØ­Ø©
            if (enteredUsername === correctUsername && enteredPassword === correctPassword) {
                
                messageElement.innerText = "ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­! Ø¬Ø§Ø±Ù Ø§Ù„ØªÙˆØ¬ÙŠÙ‡...";
                messageElement.classList.add('success-color');
                
                progressContainer.style.visibility = 'visible';
                progressBar.style.width = '100%';
                
                sessionStorage.setItem('isAuthenticated', 'true');

                setTimeout(() => {
                    showContentPage();
                }, 2000); 

            } else {
                messageElement.innerText = "Ø®Ø·Ø£ ÙÙŠ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£Ùˆ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±.";
                messageElement.classList.add('error-color');
                document.getElementById('password').value = '';
                
                setTimeout(() => {
                    loginButton.disabled = false;
                    loginButton.style.animation = 'pulse 2s infinite'; 
                }, 500); 
            }
        });

        // Ø§Ù„ØªØ­Ù‚Ù‚ Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©:
        window.onload = function() {
            if (sessionStorage.getItem('isAuthenticated') === 'true') {
                showContentPage();
            } else {
                setupLoginPage(); // Ø¹Ø±Ø¶ Ø´Ø§Ø´Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙˆØªØ¹Ø¨Ø¦Ø© Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
            }
        };
    </script>
</body>
</html>